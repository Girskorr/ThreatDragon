{
  "version": "2.2.0",
  "summary": {
    "title": "Praktikum 3 Aufgabe 1",
    "owner": "",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "New STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "position": {
              "x": 539.9999999999998,
              "y": -89.99999999999909
            },
            "size": {
              "width": 820,
              "height": 690
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "All Secure"
              }
            },
            "zIndex": -1,
            "id": "aa305cc2-d07f-426c-b963-c099ff3fe251",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "All Secure",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 829.9999999999998,
              "y": 690.0000000000017
            },
            "size": {
              "width": 490,
              "height": 270
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Telefonanbieter"
              }
            },
            "zIndex": -1,
            "id": "ec2d7476-78c2-4109-97e7-08f0cac5abc0",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Telefonanbieter",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1450,
              "y": -9.999999999999034
            },
            "size": {
              "width": 630,
              "height": 580
            },
            "shape": "trust-boundary-box",
            "attrs": {
              "headerText": {
                "text": "Externer Service für Telefonnummerauflösung"
              }
            },
            "zIndex": -1,
            "id": "b7a11df0-9828-4953-8d01-b9ca59aae63a",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Externer Service für Telefonnummerauflösung",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 100,
              "y": 240
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "id": "e0885080-3621-4839-9a65-8c13d37c6cdf",
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "ae68b04c-afbd-4f3b-8821-5f7e3d14d3c2",
                  "title": "Cross-Site Scripting (XSS)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "CAPEC-124: Shared Resource Manipulation\nCAPEC-63: Cross-Site Scripting (XSS)\n\nDurch XSS Attack kann Angreifer zugriff auf SD Karte erlangen, auf der die Appdata für alle Allsecure Anwendungen gespeichert ist. Angreifer kann dann \"invalid trust assumptions\" ausnutzen. Denn die anderen Anwendungen vertrauen generell den von geschriebenen Daten von anderen Allsecure Apps\n\nDamage (Schaden) -> 10 Schwachstelle einer Anwendung kann sich auf alle anderen Anwendungen auswirken\nReproducibility (Reproduzierbarkeit) 7 -> Angenommen Inputvalidierung wird nicht geändert, kann man immer wieder Payloads auf der SD Karte speichern\nExploitability (Ausnutzbarkeit) -> 6 Ausnutzbarkeit hängt von der Effektivität der Inputvalidierung ab \nAffected User (betroffene Nutzer) -> 4 Nur der Nutzer bei dem XSS Attack funktionert ist betroffen\n",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": "27"
                }
              ]
            }
          },
          {
            "position": {
              "x": 560,
              "y": 230.00000000000097
            },
            "size": {
              "width": 110,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Login System"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "id": "5e2d0278-eff8-4658-a92f-4fbb95d28ff9",
            "data": {
              "type": "tm.Process",
              "name": "Login System",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "914d3956-2dd9-4874-a784-c980669beb2d",
                  "title": "Server Side Request Forgery um Auth Challenge zu umgehen",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "CAPEC-664: Server Side Request Forgery\n\nAngreifer sendet eine schadhafte Anfrage an Login-Service. Die Anfrage löst eine Request Forgery aus, die die OTT dann an einen Server des Angreifers sendet. Der Angreifer kann dann mit einer weiteren Anfrage die OTT Eingabe des Nutzers immitieren und sich einloggen\n\nDamage (Schaden) -> 7 Kann sich als Nutzer ausgeben, hat aber keine Privilege escalation\nReproducibility (Reproduzierbarkeit) -> 8 Solange reproduzierbar, bis SSRF entedeckt wurde\nExploitability (Ausnutzbarkeit) -> 6 passenden Payload zu entwickeln kann schwierig sein\nAffected User (betroffene Nutzer) -> 10 Betrifft alle User",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": "31"
                }
              ]
            }
          },
          {
            "position": {
              "x": 1128,
              "y": 195.0000000000009
            },
            "size": {
              "width": 110,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Export Report"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "id": "03d19aa5-fad6-4588-81ae-021d5a817750",
            "data": {
              "type": "tm.Process",
              "name": "Export Report",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "65c350ce-3ab4-4f5f-8f25-4cf0f89423f8",
                  "title": "Bericht an Angreifer schicken",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "CAPEC 118: Collect and Analyze Information\nT1053: Scheduled Task/Job\n\nAngenommen der Export service funktioniert so, dass er einen Konfigurierten Scheduler/Worker hat, der in einem besitmmten Zeitintervall berichte schickt, kann man die Konfiguration manipulieren, so dass der Bericht nicht nur an das Management, sondern gleichzeitig auch an den Angreifer geschickt wird.\nDadurch werden alle Log Daten der Nutzer (IP,Login,Nummer) preisgegeben (hohe bedohung)\n\nDamage (Schaden) -> 10 Fatal, sensible Informationen über ALLE Nutzer werden veröffentlicht\nReproducibility (Reproduzierbarkeit) -> 10 Wenn scheduler einmal konfiguriert ist, wird der Angriff immer wieder ausgeführt\nExploitability (Ausnutzbarkeit) -> 4 Export Prozess ist nicht über das Internet erreichbar/exposed, deshalb schwierig, konfiguration des Schedulers zu ändern \nAffected User (betroffene Nutzer) -> 10 Betrifft alle Nutzer",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": "34 "
                }
              ]
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "2cf9af3c-973e-45d4-927b-2893f2c626ed",
            "source": {
              "cell": "e0885080-3621-4839-9a65-8c13d37c6cdf"
            },
            "target": {
              "cell": "5e2d0278-eff8-4658-a92f-4fbb95d28ff9"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "120a47ba-fe50-4a3c-b09c-83912b65a209",
            "source": {
              "cell": "f2b6686e-8a23-4eaa-bcc0-e42e421cc01d"
            },
            "target": {
              "cell": "c31ffb45-6cc2-4d5b-b501-9a05a07c4431"
            },
            "vertices": [
              {
                "x": 1000,
                "y": 900
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "901032e8-1446-4639-bc87-b231156b0b98",
            "source": {
              "cell": "55c688fa-8694-4444-bb1a-064040251ce7"
            },
            "target": {
              "cell": "f9160402-5381-4115-bc7c-d5cd06bc8de5"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "0cf1566b-4a99-419d-955d-79bab173dfcf",
            "source": {
              "cell": "f9160402-5381-4115-bc7c-d5cd06bc8de5"
            },
            "target": {
              "cell": "55c688fa-8694-4444-bb1a-064040251ce7"
            },
            "vertices": [
              {
                "x": 1910,
                "y": 130
              },
              {
                "x": 1910,
                "y": 230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "28f76279-2553-47aa-977a-dc064b3607fc",
            "source": {
              "cell": "9ab4badc-e234-49cb-a84e-07ee58741c25"
            },
            "target": {
              "cell": "55c688fa-8694-4444-bb1a-064040251ce7"
            },
            "vertices": [
              {
                "x": 1670,
                "y": 290
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "5b0dd2f0-83e7-4cf6-b83d-440c3811222f",
            "source": {
              "cell": "55c688fa-8694-4444-bb1a-064040251ce7"
            },
            "target": {
              "cell": "9ab4badc-e234-49cb-a84e-07ee58741c25"
            },
            "vertices": [
              {
                "x": 1690,
                "y": 370
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "c698bdfb-b009-4a70-9fd1-f5948844c08a",
            "source": {
              "cell": "9ab4badc-e234-49cb-a84e-07ee58741c25"
            },
            "target": {
              "cell": "f2b6686e-8a23-4eaa-bcc0-e42e421cc01d"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "11487b4c-0cd8-4671-97a0-98180e94208d",
            "source": {
              "cell": "47b2214f-5568-42ec-a4c3-274f1f42331e"
            },
            "target": {
              "cell": "5e2d0278-eff8-4658-a92f-4fbb95d28ff9"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "bfc90df1-1773-461f-a5d7-ddb950f15647",
            "labels": [
              "Log"
            ],
            "source": {
              "cell": "4448b0c8-b602-41ba-bb4b-318d14ba3136"
            },
            "target": {
              "cell": "ef76850d-863e-43c5-845e-34258959bb1f"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Nachricht wird über OTT Service an User versandt",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b7255cb5-d4d2-4b2a-a42f-6cf9bdf170c8",
            "labels": [
              "Nachricht wird über OTT Service an User versandt"
            ],
            "source": {
              "cell": "f2b6686e-8a23-4eaa-bcc0-e42e421cc01d"
            },
            "target": {
              "cell": "47b2214f-5568-42ec-a4c3-274f1f42331e"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Auth Challenge",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "4b616c43-113a-4bee-826a-9e572d70c3ef",
            "labels": [
              "Auth Challenge"
            ],
            "source": {
              "cell": "5e2d0278-eff8-4658-a92f-4fbb95d28ff9"
            },
            "target": {
              "cell": "4448b0c8-b602-41ba-bb4b-318d14ba3136"
            },
            "vertices": [
              {
                "x": 950,
                "y": 370
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "6e24121b-7745-4d51-a0eb-800dbb20f5bf",
            "labels": [
              "Log"
            ],
            "source": {
              "cell": "5e2d0278-eff8-4658-a92f-4fbb95d28ff9"
            },
            "target": {
              "cell": "ef76850d-863e-43c5-845e-34258959bb1f"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "signierten Bericht\nschicken",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "411f5a8c-9d29-4d21-9586-aaf0dce80872",
            "labels": [
              "signierten Bericht\nschicken"
            ],
            "source": {
              "cell": "c5a15221-afaf-4ca9-b046-e855050bad89"
            },
            "target": {
              "cell": "ea63c0ec-0cb3-4765-8e3c-632e1f4152b0"
            },
            "vertices": [
              {
                "x": 920,
                "y": 20
              },
              {
                "x": 1010,
                "y": 20
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Signierten\nBericht schicken\n",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "3af3cff6-d4b3-42d2-9bbf-748b3c0ad080",
            "labels": [
              "Signierten\nBericht schicken\n"
            ],
            "source": {
              "cell": "03d19aa5-fad6-4588-81ae-021d5a817750"
            },
            "target": {
              "cell": "ea63c0ec-0cb3-4765-8e3c-632e1f4152b0"
            },
            "vertices": [
              {
                "x": 1230,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Daten von Prozessen\nfür Auswertung",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "78fce96b-18cc-42ce-9426-24bc98af3ad2",
            "labels": [
              "Daten von Prozessen\nfür Auswertung"
            ],
            "source": {
              "cell": "ef76850d-863e-43c5-845e-34258959bb1f"
            },
            "target": {
              "cell": "c5a15221-afaf-4ca9-b046-e855050bad89"
            },
            "vertices": [
              {
                "x": 870,
                "y": 90
              },
              {
                "x": 770,
                "y": 60
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Daten fetchen",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "57784ba4-ff21-406e-bccf-1d459ba4d0c8",
            "labels": [
              "Daten fetchen"
            ],
            "source": {
              "cell": "03d19aa5-fad6-4588-81ae-021d5a817750"
            },
            "target": {
              "cell": "ef76850d-863e-43c5-845e-34258959bb1f"
            },
            "vertices": [
              {
                "x": 1110,
                "y": 150
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "5b07b2f4-e737-4495-9c9b-d3ef8985870a",
            "labels": [
              "Log"
            ],
            "source": {
              "cell": "47b2214f-5568-42ec-a4c3-274f1f42331e"
            },
            "target": {
              "cell": "ef76850d-863e-43c5-845e-34258959bb1f"
            },
            "vertices": [
              {
                "x": 850,
                "y": 220
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Weiterleitung Telefonnummer",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ce21b33a-a141-4f41-9a2f-9ab646fc573f",
                  "title": "Adversary in the Middle (AiTM)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "CAPEC-94: Adversary in the Middle (AiTM)\nT1557: Adversary-in-the-Middle\n\nWenn Angreifer Symmetrischen Key kennt (der unverschlüsselt in der Config liegt), kann er den Auflösungsrequest abfangen und seine eigene Nummer eintragen. Der Gateway der Telefonnummerauflösung schickt den Token dann zu der Nummer des Angreifers, anstatt an den User.\nDa der Token ein Jahr gültig ist, kann der Angreifer Problemlos Sessions starten, wenn er auch die Login Daten des Users kennt\n\nDamage (Schaden) -> 7 Angreifer kann Session eines Nutzers übernehmen.\nReproducibility (Reproduzierbarkeit) 10 -> Wenn Angreifer den Symmetrischen Schlüssel erlangt hat, kann er den Angriff bei jedem Request starten\nExploitability (Ausnutzbarkeit) 4 -> Damit dieser Angriff funktioniert, muss erstmal der Schlüssel erlangt werden, was schwierig sein kann\nAffected User (betroffene Nutzer) -> 4 Es ist nur der Nutzer betroffen, der sich einloggen will\n",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": "25"
                }
              ]
            },
            "id": "e9aab29d-c3d4-4992-807d-52dabc8a4a87",
            "labels": [
              "Weiterleitung Telefonnummer"
            ],
            "source": {
              "cell": "4448b0c8-b602-41ba-bb4b-318d14ba3136"
            },
            "target": {
              "cell": "9ab4badc-e234-49cb-a84e-07ee58741c25"
            }
          },
          {
            "position": {
              "x": 920,
              "y": 60
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log DB"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "id": "ef76850d-863e-43c5-845e-34258959bb1f",
            "data": {
              "type": "tm.Store",
              "name": "Log DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "29295d82-c063-4910-81b8-451c91479b4f",
                  "title": "Log Files manipulieren",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "CAPEC-93: Log Injection-Tampering-Forging\n\nAngreifer kann die Log-Daten seiner eigenen Requests in der DB löschen oder manipulieren, um seine Spuren zu verwischen\n\nDamage (Schaden)-> 4 Es entsteht kein direketer Schaden für Nutzer\nReproducibility (Reproduzierbarkeit) -> Wenn man\nExploitability (Ausnutzbarkeit)\nAffected User (betroffene Nutzer)",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 1193.749999999999,
              "y": -20
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Management"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 12,
            "id": "ea63c0ec-0cb3-4765-8e3c-632e1f4152b0",
            "data": {
              "type": "tm.Actor",
              "name": "Management",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "e8c675cf-2096-4a31-b4e7-41eb43877356",
                  "title": "Management Report spoofing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "CAPEC-134: Email Injection\nT1566: Phishing \n\nWenn Angreifer durch vorheriges Footprinting weiß, dass ein Report vom Management erwartet wird, kann er den Report imitieren und schadhafte Daten schicken\n\nDamage (Schaden) 6 -> variiert je nach Payload, den das Management öffnet\nReproducibility (Reproduzierbarkeit) 3 -> Ob Angriff funktioniert hängt davon ab, ob Management auf den Angriff reinfällt. Reproduzierbarkeit kann genauer bewertet werden, wenn man das technische know-how des Managements kennt\nExploitability (Ausnutzbarkeit) -> 10 Es ist sehr einfach, Pishing Mails zu schreiben\nAffected User (betroffene Nutzer) -> 7 Kommt darauf an, was der gesendete Payload auslöst",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": "26"
                }
              ]
            }
          },
          {
            "position": {
              "x": 1098,
              "y": 345.00000000000097
            },
            "size": {
              "width": 140,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "2-Faktor\n Authentifizierungs\ndienst"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "id": "4448b0c8-b602-41ba-bb4b-318d14ba3136",
            "data": {
              "type": "tm.Process",
              "name": "2-Faktor\n Authentifizierungs\ndienst",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "b6c6cecc-b7f2-4376-b9b0-ba343d307c6c",
                  "title": "Adversary in the Middle (AiTM)",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "CAPEC-94: Adversary in the Middle (AiTM)\nT1557: Adversary-in-the-Middle​\n\nWenn Angreifer Symmetrischen Key kennt (der unverschlüsselt in der Config liegt), kann er den Auflösungsrequest abfangen und seine eigene Nummer eintragen. Der Gateway der Telefonnummerauflösung schickt den Token dann zu der Nummer des Angreifers, anstatt an den User.​\n\nDa der Token ein Jahr gültig ist, kann der Angreifer Problemlos Sessions starten, wenn er auch die Login Daten des Users kennt​\n\nDREAD​\n\nDamage (Schaden) -> 7 Angreifer kann Session eines Nutzers übernehmen.\nReproducibility (Reproduzierbarkeit) 10 -> Wenn Angreifer den Symmetrischen Schlüssel erlangt hat, kann er den Angriff bei jedem Request starten\nExploitability (Ausnutzbarkeit) 4 -> Damit dieser Angriff funktioniert, muss erstmal der Schlüssel erlangt werden, was schwierig sein kann\nAffected User (betroffene Nutzer) -> 4 Es ist nur der Nutzer betroffen, der sich einloggen will​",
                  "mitigation": "D3-MENCR: Message Encryption​\n\n- Asymmetrische Verschlüsselung statt Symmetrische verwenden​\n- Operations-Team muss Configuration des Servers auf dem der Dienst läuft, ändern​\n- Exploitability und Reproducibility wird verringet, schaden und Affected Users bleibt gleich",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": "25"
                }
              ]
            }
          },
          {
            "position": {
              "x": 321,
              "y": 240
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Login\n"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 17,
            "id": "a8143c81-3b78-47f2-89ff-627dab9e2064",
            "data": {
              "type": "tm.Text",
              "name": "Login\n",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1113,
              "y": 795
            },
            "size": {
              "width": 110,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Kundentelefon\nanbieter"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 18,
            "id": "f2b6686e-8a23-4eaa-bcc0-e42e421cc01d",
            "data": {
              "type": "tm.Process",
              "name": "Kundentelefon\nanbieter",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 869.9999999999991,
              "y": 809
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Telefonnummer \nDB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 19,
            "id": "c31ffb45-6cc2-4d5b-b501-9a05a07c4431",
            "data": {
              "type": "tm.Store",
              "name": "Telefonnummer \nDB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1500,
              "y": 265
            },
            "size": {
              "width": 100,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Telefonnummer \nAPI Gateway"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 21,
            "id": "9ab4badc-e234-49cb-a84e-07ee58741c25",
            "data": {
              "type": "tm.Process",
              "name": "Telefonnummer \nAPI Gateway",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1775,
              "y": 245
            },
            "size": {
              "width": 190,
              "height": 160
            },
            "attrs": {
              "text": {
                "text": "Telefon \nRouting Interface"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 22,
            "id": "55c688fa-8694-4444-bb1a-064040251ce7",
            "data": {
              "type": "tm.Process",
              "name": "Telefon \nRouting Interface",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 1705,
              "y": 40
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Routing Information\nDB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 23,
            "id": "f9160402-5381-4115-bc7c-d5cd06bc8de5",
            "data": {
              "type": "tm.Store",
              "name": "Routing Information\nDB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1731,
              "y": 145
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Request"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 24,
            "id": "874a6067-c2bb-406f-9f96-e08ed91abe05",
            "data": {
              "type": "tm.Text",
              "name": "Request",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1891,
              "y": 80
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Response"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 25,
            "id": "e8627ed7-6a9e-45e1-9711-2b470254923a",
            "data": {
              "type": "tm.Text",
              "name": "Response",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1632,
              "y": 240
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Nummer"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 26,
            "id": "3e0b0640-251e-42fe-95ef-0c6ded0b0cec",
            "data": {
              "type": "tm.Text",
              "name": "Nummer",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1662.5,
              "y": 360
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Effektive Telefongesellschaft"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 27,
            "id": "254b9cc9-425b-4f79-b568-0d5f98f9d06c",
            "data": {
              "type": "tm.Text",
              "name": "Effektive Telefongesellschaft",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1319.999999999999,
              "y": 600.0000000000009
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Telefonnummer mit OTT"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 28,
            "id": "f1a46195-7478-4cd5-ac04-b92d4eb4c80a",
            "data": {
              "type": "tm.Text",
              "name": "Telefonnummer mit OTT",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 714.9999999999991,
              "y": 405
            },
            "size": {
              "width": 170,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Allsecure OTT Service"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 29,
            "id": "47b2214f-5568-42ec-a4c3-274f1f42331e",
            "data": {
              "type": "tm.Process",
              "name": "Allsecure OTT Service",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "f6048cbf-84ac-490b-b38e-864246b9dc9c",
                  "title": "NoSQL Injection Log DB",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "description": "CAPEC-676: NoSQL Injection\n\nWenn Angreifer dafür sorgt, das eine Telefongesellschaft eine Nachricht and den OTT-Service von Allsecure sendet, kann in der Nachricht (die die Telco einfach nur weiterleitet) ein schadhaftes NoSQL Statement stehen, dass zu elevation of privilege führt. NoSQL wird wegen Logging verwendet\n\nDamage (Schaden) -> 9 Elevation of Privilege kann beliebig groß sein\nReproducibility (Reproduzierbarkeit) -> 8 Wenn das Setup für den Angriff einmal steht, kann man den Angriff beliebig oft ausführen. Kann aber bei zu vielen Angriffen von SIEM entdeckt werden\nExploitability (Ausnutzbarkeit) -> 4 Telco zu dem Request an OTT-Service zu bringen, kann kompliziert und auch kostspielig sein, da jede Telefonnummerauflösung Gebühren kostet\nAffected User (betroffene Nutzer) -> 10 Es ist vertikale wie auch horizontale Elevation möglich\n",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": "31"
                }
              ]
            }
          },
          {
            "position": {
              "x": 651,
              "y": 320
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "OTT"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 31,
            "id": "73150ea4-ebf5-4716-9db7-47ed0bddc241",
            "data": {
              "type": "tm.Text",
              "name": "OTT",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 990,
              "y": 880
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Nummer auslesen"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 33,
            "id": "d5f722c3-d6cd-4c79-a168-a701d12b8213",
            "data": {
              "type": "tm.Text",
              "name": "Nummer auslesen",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 599.9999999999991,
              "y": -50
            },
            "size": {
              "width": 130,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "SIEM"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 35,
            "id": "c5a15221-afaf-4ca9-b046-e855050bad89",
            "data": {
              "type": "tm.Process",
              "name": "SIEM",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "71f108fa-2432-4714-ac4a-34cd7a1b0459",
                  "title": "DoS Attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "CAPEC-125: Flooding\nEndpoint Denial of Service: Application Exhaustion Flood\n\nDer Angreifer sendet extrem viele Login Anfragen an den Login-Service. Dadurch erhält der SIEM-Service große Datenmengen vom Login-Service und auch vom 2Faktor-Service (siehe Diagramm).\nSIEM erhält also pro Flooding-Request von zwei Prozessen Daten. Man kann deshalb davon ausgehen, das SIEM früher ausfällt als Login-Service, sodass Angreifer eigentliche Attacke noch ausführen kann\n\nWenn der SIEM-Service dann nicht mehr erreichbar ist, kann der Angreifer den eigentlichen Angriff starten, den der SIEM-Service nicht erkennen soll.\n\nDREA(D):\nDamage (Schaden) -> 4 Beeinflusst nicht die Businesslogik, nur Audit/Monitoring wird beeinträchtigt\nReproducibility (Reproduzierbarkeit) -> 3 Wenn Flooding entdeckt wurde, wird System wahrscheinlich gehärtet und erneute DoS Attacks schwieriger\nExploitability (Ausnutzbarkeit) -> 8 Flooding durch Tools leicht umsetzbar\nAffected User (betroffene Nutzer) -> 0 Es sind keine Nutzer betroffen\n\n",
                  "mitigation": "Provide remediation for this threat or a reason if status is N/A",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": "15"
                }
              ]
            }
          }
        ],
        "description": "Aufgabe 1"
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 11
  }
}